<!DOCTYPE html>
<html lang="ne">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nepal GK Quiz | Ujwal Pandey</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
</head>

<body>

<!-- START SCREEN -->
<div id="startScreen" class="start-screen">
  <div class="start-box">
    <img src="https://i.ibb.co/M6dM5Q3/nepal-flag.gif" class="flag">
    <h1>Nepal GK Official Quiz</h1>
    <p>Test your knowledge ‚Ä¢ Secure Proctored Quiz</p>
    <button class="start-btn" onclick="beginQuiz()">Start Quiz</button>
  </div>
</div>

<!-- QUIZ CONTAINER -->
<div id="quizContainer" class="quiz-container glass hidden">

  <div class="header">
    <h2>üá≥üáµ Nepal GK Secure Quiz</h2>
    <span id="timer">‚è± 05:00</span>
  </div>

  <form id="quizForm">

    <input type="text" id="playerName" placeholder="Full Name" required>
    <input type="email" id="playerEmail" placeholder="Email" required>

    <div id="questions-wrapper"></div>

    <button type="button" id="submitBtn" onclick="submitQuiz()">Submit Quiz</button>
    <div id="resultBox"></div>
  </form>
</div>

<!-- SOUNDS -->
<audio id="tickSound" src="tick.mp3"></audio>
<audio id="timeUpSound" src="timeup.mp3"></audio>

<script>

/* START SCREEN */
function beginQuiz() {
  document.getElementById("startScreen").classList.add("hidden");
  const quizBox = document.getElementById("quizContainer");
  quizBox.style.display = "block";
}

/* QUIZ DATA */
const quizData = [
  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§Æ‡§æ ‡§™‡§π‡§ø‡§≤‡•ã ‡§∞‡•á‡§≤‡§∏‡•á‡§µ‡§æ ‡§ï‡§π‡§æ‡§Å ‡§∏‡§û‡•ç‡§ö‡§æ‡§≤‡§® ‡§≠‡§Ø‡•ã?<br>When was Nepal‚Äôs first railway operated?",
    options:["Raxaul ‚Äì Amlekhganj","Birgunj ‚Äì Simara","Janakpur ‚Äì Jaynagar","Biratnagar ‚Äì Rangeli"],
    correct:"Raxaul ‚Äì Amlekhganj" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§ú‡§≤‡§µ‡§ø‡§¶‡•ç‡§Ø‡•Å‡§§‡•ç ‡§Ü‡§Ø‡•ã‡§ú‡§®‡§æ ‡§ï‡•Å‡§® ‡§π‡•ã?<br>First hydroelectric project?",
    options:["Pharping","Trishuli","Kulekhani","Sunkoshi"],
    correct:"Pharping" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§¨‡•à‡§Ç‡§ï ‡§ï‡•Å‡§® ‡§π‡•ã?<br>First bank of Nepal?",
    options:["Nepal Bank Limited","Nepal Rastra Bank","Agriculture Development Bank","Rastriya Banijya Bank"],
    correct:"Nepal Bank Limited" },

  { q:"‡§®‡•á‡§™‡§æ‡§≤‡§ï‡•ã ‡§™‡§π‡§ø‡§≤‡•ã ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§® ‡§ï‡§π‡§ø‡§≤‡•á ‡§ú‡§æ‡§∞‡•Ä?<br>First constitution?",
    options:["1948 A.D.","1951 A.D.","1962 A.D.","1990 A.D."],
    correct:"1948 A.D." },

  { q:"‡§®‡•á‡§™‡§æ‡§≤ UN ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§π‡§ø‡§≤‡•á?<br>When did Nepal join UN?",
    options:["1955 A.D.","1950 A.D.","1957 A.D.","1961 A.D."],
    correct:"1955 A.D." },

  { q:"‡§™‡§π‡§ø‡§≤‡•ã ‡§µ‡§ø‡§∂‡•ç‡§µ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø ‡§ï‡•Å‡§®?<br>First university?",
    options:["Tribhuvan University","Kathmandu University","Purbanchal University","MWU"],
    correct:"Tribhuvan University" },

  { q:"‡§™‡§π‡§ø‡§≤‡•ã ‡§õ‡§æ‡§Ø‡§æ‡§ô‡•ç‡§ï‡§® ‡§ö‡§≤‡§ö‡§ø‡§§‡•ç‡§∞?<br>First Nepali filmed movie?",
    options:["Aama","Satya Harischandra","Maitighar","Harischandra"],
    correct:"Aama" },

  { q:"‡§∞‡§æ‡§∑‡•ç‡§ü‡•ç‡§∞‡§ø‡§Ø ‡§∏‡§≠‡§æ ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§ï‡§§‡§ø?<br>National Assembly members?",
    options:["59","56","60","61"],
    correct:"59" },

  { q:"‡§™‡§π‡§ø‡§≤‡•ã ‡§ú‡§®‡§ó‡§£‡§®‡§æ?<br>First census?",
    options:["1911 A.D.","1941 A.D.","1952 A.D.","1961 A.D."],
    correct:"1911 A.D." },

  { q:"SAARC ‡§ö‡§æ‡§∞‡•ç‡§ü‡§∞ ‡§ï‡§π‡§ø‡§≤‡•á ‡§∏‡§æ‡§á‡§®?<br>When was SAARC charter signed?",
    options:["8 December 1985","6 January 1984","10 December 1986","1 Nov 1985"],
    correct:"8 December 1985" },

  { q:"‡§™‡§π‡§ø‡§≤‡•ã ‡§Ü‡§®‡•ç‡§§‡§∞‡§ø‡§ï ‡§â‡§°‡§æ‡§®?<br>First domestic flight?",
    options:["1950 A.D., Kathmandu‚ÄìSimara","1949 A.D., Kathmandu‚ÄìPokhara","1950 A.D., Kathmandu‚ÄìBiratnagar","1951 A.D., Kathmandu‚ÄìJanakpur"],
    correct:"1950 A.D., Kathmandu‚ÄìSimara" }
];

/* SHUFFLE */
function shuffle(a){for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}
shuffle(quizData);
quizData.forEach(q=>q.options=shuffle(q.options));

/* DISPLAY QUESTIONS */
const wrapper=document.getElementById("questions-wrapper");
quizData.forEach((item,i)=>{
  const div=document.createElement("div");
  div.classList.add("question");
  let html=`<h3>${i+1}. ${item.q}</h3>`;
  item.options.forEach(opt=>{
    html+=`<label><input type="radio" name="q${i}" value="${opt}"> ${opt}</label>`;
  });
  div.innerHTML=html;
  wrapper.appendChild(div);
});

/* TIMER */
let timeLeft=300;
const timerDisplay=document.getElementById("timer");

const countdown=setInterval(()=>{
  const m=Math.floor(timeLeft/60);
  const s=timeLeft%60;
  timerDisplay.textContent=`‚è± ${m.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`;

  if(timeLeft<=10 && timeLeft>0){
    document.getElementById("tickSound").play();
  }

  timeLeft--;
  if(timeLeft<0){
    document.getElementById("timeUpSound").play();
    clearInterval(countdown);
    submitQuiz();
  }
},1000);

/* ANTI-CHEAT */
window.onblur=()=>{
  alert("‚ö†Ô∏è Tab switch detected! Auto-submitting.");
  submitQuiz();
};

/* SUBMIT */
async function submitQuiz(){

  clearInterval(countdown);
  document.getElementById("submitBtn").disabled=true;

  const name=document.getElementById("playerName").value;
  const email=document.getElementById("playerEmail").value;
  if(!name||!email)return alert("Enter your name & email.");

  let score=0;
  let answersDetailed=[];
  
  quizData.forEach((q,i)=>{
    const sel=document.querySelector(`input[name="q${i}"]:checked`);
    const userAns=sel?sel.value:"Not answered";
    const correct=userAns===q.correct;
    if(correct)score++;

    answersDetailed.push({
      question:q.q, user:userAns, correctAns:q.correct, correct
    });
  });

  const percent=((score/quizData.length)*100).toFixed(2);

  let badge="";
  if(percent>=90) badge="ü•á Gold Badge ‚Äì Excellent!";
  else if(percent>=70) badge="ü•à Silver Badge ‚Äì Great Job!";
  else if(percent>=50) badge="ü•â Bronze Badge ‚Äì Good Effort!";
  else badge="‚ùå Try Again ‚Äì Keep Practicing!";

  document.getElementById("resultBox").innerHTML=`
    <h3>${name}, your result:</h3>
    <p>Score: ${score}/${quizData.length} (${percent}%)</p>
    <h2>${badge}</h2>
    <p>Certificate + answers are being emailed‚Ä¶</p>
  `;
  document.getElementById("resultBox").style.display="block";

  /* SEND TO APPS SCRIPT */
  await fetch("YOUR_SCRIPT_URL_HERE",{
    method:"POST",mode:"no-cors",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      name,email,score,percent,
      badge,
      total:quizData.length,
      answersDetailed
    })
  });

  alert("‚úÖ Certificate sent to your email!");
}

</script>

</body>
</html>
